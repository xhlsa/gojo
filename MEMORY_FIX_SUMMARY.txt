â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ MEMORY GROWTH ROOT CAUSE: 122 MB vs 90-96 MB Target               â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

FINDING: Incomplete implementation of 3-tier memory optimization plan

â”Œâ”€ Nov 13 CLAUDE.md Plan â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tier 1: Clear accumulated_data after auto-save     âœ… IMPLEMENTED   â”‚
â”‚ Tier 2: Reduce queue sizes 500â†’100               âš ï¸ PARTIAL       â”‚
â”‚ Tier 3: Pause ES-EKF at 95 MB                     âœ… IMPLEMENTED   â”‚
â”‚ Plus:   Trajectory deques                         âŒ MISSING       â”‚
â”‚ Plus:   Incident list clearing                    âŒ MISSING       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Memory Impact of Missing Fixes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                    â”‚
â”‚ Issue #1: Trajectory Deques at 10000 (should be 1000)             â”‚
â”‚ â”œâ”€ ekf_trajectory: 10000 points Ã— 200 bytes     = 2.0 MB          â”‚
â”‚ â”œâ”€ es_ekf_trajectory: 10000 points Ã— 200 bytes  = 2.0 MB          â”‚
â”‚ â”œâ”€ comp_trajectory: 10000 points Ã— 200 bytes    = 2.0 MB          â”‚
â”‚ â””â”€ SUBTOTAL:                                      6.0 MB  ğŸ’¾        â”‚
â”‚                                                                    â”‚
â”‚ Issue #2: Incident List Never Cleared                             â”‚
â”‚ â”œâ”€ self.incidents = [] (list grows indefinitely)                  â”‚
â”‚ â”œâ”€ 45-min test: ~100-300 incidents Ã— 500B       = 0.5-2 MB        â”‚
â”‚ â””â”€ SUBTOTAL:                                      1.5 MB  ğŸ’¾        â”‚
â”‚                                                                    â”‚
â”‚ Issue #3: Raw Queues Still at 1000                                â”‚
â”‚ â”œâ”€ accel_raw_queue: 1000 Ã— 12B                  = 11.7 KB         â”‚
â”‚ â”œâ”€ gyro_raw_queue: 1000 Ã— 12B                   = 11.7 KB         â”‚
â”‚ â””â”€ SUBTOTAL:                                      23 KB   ğŸ’¾       â”‚
â”‚                                                                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚ TOTAL MISSING OPTIMIZATIONS:                ~7.5-8.5 MB         â”‚
â”‚ â”‚                                                                 â”‚
â”‚ â”‚ Expected (with full optimization): 90-96 MB                     â”‚
â”‚ â”‚ Actual (incomplete):               98-122 MB âœ—                  â”‚
â”‚ â”‚ Discrepancy matches: 7.5 MB âœ“                                   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Fixes Required â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                    â”‚
â”‚ 1ï¸âƒ£  PRIORITY 1: Reduce trajectory deques from 10000â†’1000          â”‚
â”‚     File: motion_tracker_v2/test_ekf_vs_complementary.py          â”‚
â”‚     Lines: 411-414                                                â”‚
â”‚     Savings: 5-6 MB                                               â”‚
â”‚     Effort: 3 lines (change maxlen value)                         â”‚
â”‚                                                                    â”‚
â”‚ 2ï¸âƒ£  PRIORITY 2: Clear incident list after auto-save               â”‚
â”‚     File: motion_tracker_v2/test_ekf_vs_complementary.py          â”‚
â”‚     After line: 2027 (_save_results)                              â”‚
â”‚     Savings: 1-2 MB                                               â”‚
â”‚     Effort: 2 lines (if hasattr check + clear)                    â”‚
â”‚                                                                    â”‚
â”‚ 3ï¸âƒ£  PRIORITY 3: Reduce raw queues from 1000â†’100                   â”‚
â”‚     File: motion_tracker_v2/test_ekf_vs_complementary.py          â”‚
â”‚     Lines: 423, 425                                               â”‚
â”‚     Savings: 23 KB (consistency)                                  â”‚
â”‚     Effort: 2 lines (change maxsize value)                        â”‚
â”‚                                                                    â”‚
â”‚ 4ï¸âƒ£  PRIORITY 4: Document covariance_snapshots                     â”‚
â”‚     File: motion_tracker_v2/test_ekf_vs_complementary.py          â”‚
â”‚     Line: 414                                                     â”‚
â”‚     Savings: 0.05 MB (minor)                                      â”‚
â”‚     Effort: 1 line (comment)                                      â”‚
â”‚                                                                    â”‚
â”‚ TOTAL EFFORT: ~7 lines of code changes                            â”‚
â”‚ TOTAL RECOVERY: 6-8 MB                                            â”‚
â”‚ EXPECTED RESULT: 95-100 MB (stable, within bounds)                â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Verification Checklist â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–¡ Grep logs for "MEMORY PRESSURE" - did ES-EKF pause trigger?    â”‚
â”‚ â–¡ Check comparison_*.json - count trajectories (should see max)   â”‚
â”‚ â–¡ Verify incident_detector.incidents size in saved data          â”‚
â”‚ â–¡ Run test and monitor: memory should stay 90-100 MB             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STATUS: Root cause identified, fix path clear
CONFIDENCE: High (7.5 MB discrepancy matches observed 122-96=26MB overage)
